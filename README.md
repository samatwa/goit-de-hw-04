# goit-de-hw-04

![alt text](part1_all_jobs.png)

# Опис Jobs:
## Job 1 — Інференс схеми CSV
Spark читає кілька рядків з файлу для визначення типів колонок, оскільки використано .option("inferSchema", "true").
Легка операція, окремий Job для цього.
## Job 2 — Читання CSV, фільтрація, селект, підготовка до shuffle (Map Stage)
Spark повністю читає CSV-файл.
Застосовує .where("final_priority < 3") та .select("unit_id", "final_priority").
Потім готує дані для групування — це Map Stage.
Результати діляться по ключу unit_id для подальшого shuffle.
## Job 3 — Виконання shuffle та агрегація (Reduce Stage)
Тут відбувається shuffle (перемішування даних між виконавцями за ключами unit_id).
Далі Spark виконує .count() для кожної групи.
Це Reduce Stage — збирання та підрахунок.
## Job 4 — Фільтрація .where("count>2")
Додаткова фільтрація вже після групування.
Spark запускає окремий етап для застосування цього фільтру.
## Job 5 — Збирання результатів (Collect)
Після всіх трансформацій Spark збирає результати на драйвер для .collect().
 
![alt text](part2_all_jobs.png)

# Опис Jobs:
## Job 1 — Інференс схеми CSV
Як і раніше, Spark читає кілька рядків для визначення схеми.
## Job 2 — Читання CSV, фільтрація, селект, підготовка до shuffle (Map Stage) для першого .collect()
Повне читання даних.
Фільтрація, селекція та підготовка до групування.
## Job 3 — Shuffle + групування + count (Reduce Stage) для першого .collect()
Shuffle та агрегація груп.
## Job 4 — Збирання результатів (Collect)
Spark збирає підраховані групи назад на драйвер для першого .collect().
## Job 5 — Читання CSV, фільтрація, селект, shuffle (Map Stage) для другого .collect()
Spark не кешує попередні обчислення!
Він починає обчислення з самого початку.
Знову читає файл, застосовує фільтри та готує дані до shuffle.
## Job 6 — Shuffle + групування + count (Reduce Stage) для другого .collect()
Знову shuffle та агрегація.
## Job 7 — Додаткова фільтрація .where("count>2")
Застосування фільтру після групування.
## Job 8 — Збирання результатів (Collect)
Другий виклик .collect() збирає результати на драйвер.

![alt text](part3_all_jobs.png)
